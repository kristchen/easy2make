{% extends 'easy2make/templates/base.html' %}

{% load bootstrap3 %}
{% load static %}
{% block content %}

<link rel="stylesheet" href="{% static 'css/jquery-ui.min.css' %}" type="text/css">

<div class="row" style="padding-bottom: 1rem;">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="#">Vendas</a></li>
        <li class="breadcrumb-item"><a href="#">Cadastrar</a></li>
    </ol>
</div>

<form action="#" role="form">       
    {% csrf_token %}
    <input type="hidden" id="id_venda" value="{{venda.id}}">
    <div class="form-group">
        <label class="control-label" for="cliente">Cliente</label>
        <input type="text" name="cliente" maxlength="255" class="form-control" placeholder="Cliente" title="" required="" id="cliente">
    </div>
    
    <table class="table table-striped table-sm">
        <thead>
            <tr>
                <th>Nome</th>
                <th>Telefone</th>
                <th style="text-align:right"></th>
            </tr>
        </thead>
        <tbody id="tbody-cliente">

            <tr>
                <td>{{venda.cliente.nome}}</td>
                <td>{{venda.cliente.telefone}}</td>
                <td style="text-align: right;">
                    <i class="fa fa-trash cliente-remove" style="cursor: pointer;"></i>
                </td>
            </tr>
            
        </tbody>
    </table>
    
    <div class="form-group">
        <label class="control-label" for="descricao">Produto</label>
        <input type="text" name="descricao" readonly maxlength="255" class="form-control" placeholder="Produto" title="" required="" id="descricao">
    </div>
    
    <table class="table table-striped table-sm">
        <thead class="black white-text">
            <tr><th colspan="3">Produtos</th></tr>
            <tr>
                <th>Descrição</th>
                <th>Preço</th>
                <th>Estoque</th>
                <th class="col-sm-1" >Quantidade</th>
                <th class="col-sm-1"></th>
            </tr>
        </thead>
        <tbody id="tbody-produto">
            
        {% for item in venda.itens %}
            <tr id="{{item.id}}">
                <td>{{item.produto.descricao}}</td>
                <td>{{item.produto.preco | floatformat:2}}</td>
                <td estoque="{{item.produto.quantidade}}">3</td>
                
                {% with ''|center:item.produto.quantidade as range %}
                <td>
                    
                    <select class="form-control">
                        {% for _ in range %}
                            <option 
                                {% if forloop.counter == item.quantidade %}
                                    selected
                                {% endif %}    
                            value="{{ forloop.counter }}">{{ forloop.counter }}</option>
                        {% endfor %}
                    </select>
                
                </td>
                {% endwith %}
                
                <td style="text-align: right;">
                    <i class="fa fa-trash produto-remove" style="cursor: pointer;"></i>
                </td>
            </tr>
        {% endofor %}

        </tbody>
    </table>
    <hr>
    <div class="pull-right">
        <label id="total">Total: R$ {{venda.total}}</label>
    </div>
    
    <input type="button" id="btn-finalizar" value="Finalizar Venda" class="btn btn-primary">
    <input style="display:none" type="button" id="btn-cupom" value="Imprimir Cupom" class="btn btn-primary">
    
    
</form>

<script type="text/javascript" src="{%  static 'js/printThis.js' %}"></script>
<script type="text/javascript" src="{% static 'js/jquery-ui.min.js' %}" ></script>
<script type="text/javascript" src="{% static 'js/vendas.js' %}"></script> 


{% endblock %}